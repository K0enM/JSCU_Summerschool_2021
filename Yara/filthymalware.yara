/*
    This Yara ruleset is under the GNU-GPLv2 license (http://www.gnu.org/licenses/gpl-2.0.html) and open to any user or organization, as long as you use it under this license.
*/

rule Filthy_Malware_Detector {
	meta:
		author = "JSCU Summerschool"
		description = "Detects many common malware samples"
		date = "1337-01"
	strings:
		$f1 = "procexp.exe" nocase
		$f2 = "procmon.exe" nocase
		$f3 = "processmonitor.exe" nocase
		$f4 = "wireshark.exe" nocase
		$f5 = "fiddler.exe" nocase
		$f6 = "windbg.exe" nocase
		$f7 = "ollydbg.exe" nocase
		$f8 = "winhex.exe" nocase
		$f9 = "processhacker.exe" nocase
		$f10 = "hiew32.exe" nocase
		
		$advapi32 = "advapi32.dll" wide ascii nocase
		$CryptCreateHash = "CryptCreateHash" wide ascii
		$CryptHashData = "CryptHashData" wide ascii
		$CryptAcquireContext = "CryptAcquireContext" wide ascii
		$crc = { 00 00 00 00 96 30 07 77 2C 61 0E EE BA 51 09 99 19 C4 6D 07 }
		
		$key = { 03 00 00 00 05 00 00 00 07 00 00 00 0B 00 00 00 0D 00 00 00 11 00 00 00 13 00 00 00 17 00 00 00 1D 00 00 00 1F 00 00 00 25 00 00 00 29 00 00 00 2B 00 00 00 2F 00 00 00 35 00 00 00 3B 00 00 00 3D 00 00 00 43 00 00 00 47 00 00 00 49 00 00 00 4F 00 00 00 53 00 00 00 59 00 00 00 61 00 00 00 65 00 00 00 67 00 00 00 6B 00 00 00 6D 00 00 00 71 00 00 00 7F 00 00 00 83 00 00 00 89 00 00 00 8B 00 00 00 95 00 00 00 97 00 00 00 9D 00 00 00 A3 00 00 00 A7 00 00 00 AD 00 00 00 B3 00 00 00 B5 00 00 00 BF 00 00 00 C1 00 00 00 C5 00 00 00 C7 00 00 00 D3 00 00 00 DF 00 00 00 E3 00 00 00 E5 00 00 00 E9 00 00 00 EF 00 00 00 F1 00 00 00 FB 00 00 00 }
		
		$key2 = { 55 02 76 00 00 11 57 59 4a 53 43 55 7b 68 45 78 5f 65 4e 63 30 64 31 6e 47 5f 72 55 4c 65 53 53 53 7d 01 c9 03 00 00 0c 78 4d }

	condition:
		8 of them
}



